import{r as g,j as e,t as B,u as se,b as R,d as le,H as ne,a as ie}from"./app-rUhqRxjb.js";import{B as f}from"./app-logo-icon-Bhdv87vF.js";import{T as re,a as oe,I as de,b as ce,c as D,A as me}from"./tabs-3GY3ZUdb.js";import{u as ue,a as I,b as he,e as pe,A as xe}from"./app-layout-DT4Xblzp.js";import{I as F}from"./input-ClKPMiIi.js";import{L as C}from"./label-KHMULqRn.js";import{T as M}from"./alert-dialog-zBpEOBNY.js";import{U as _e}from"./upload-BSyCMAFU.js";import{S as V,a as J,b as G,c as H,d as k}from"./select-DIkDvF-4.js";import{D as W,a as X,b as Y,c as Z,d as be}from"./dialog-CxnlLnNg.js";import{C as je}from"./checkbox-BQEnh9jy.js";import{T as ge}from"./textarea--CdritW9.js";import{D as ve}from"./DeleteDialog-KhsbbrZh.js";import{B as O}from"./badge-nEU-2Dl1.js";import{S as fe}from"./square-pen-D87X21Bl.js";/* empty css            */import"./index-JAreR6JF.js";import"./index-CLnxC0Re.js";import"./index-4Ns3tNZl.js";import"./index-CR8Cmt41.js";import"./chevron-down-CkKdl1u6.js";function ye({contact:a,onSuccess:r,onCancel:s,resourceLabel:t="",subjectLabel:o=""}){const[n,l]=g.useState({contact_name:a?.contact_name||"",relationship:a?.relationship||"",phone:a?.phone||"",email:a?.email||"",address:a?.address||"",is_primary:a?.is_primary||!1}),[d,x]=g.useState(null),[b,i]=g.useState(a?.photo_url||null),[m,y]=g.useState(!1),[h,P]=g.useState({}),A=g.useRef(null),T=async()=>{y(!0),P({});try{const _={};if(n.contact_name.trim()||(_.contact_name="Contact name is required"),n.relationship.trim()||(_.relationship="Relationship is required"),n.phone.trim()||(_.phone="Phone number is required"),Object.keys(_).length>0){P(_);return}const j={id:a?.id||`temp_${Date.now()}`,contact_name:n.contact_name,relationship:n.relationship,phone:n.phone,email:n.email||"",address:n.address||"",is_primary:n.is_primary,photo:d?d.name:a?.photo||"",photo_url:b||a?.photo_url||"",created_at:a?.created_at||new Date().toISOString(),updated_at:new Date().toISOString(),_photoFile:d||void 0,_isNew:!a,_isModified:!!a};B.success(a?`Contact changes staged - save ${o.toLowerCase()} to apply`:`Contact staged - save ${o.toLowerCase()} to apply`),r(j)}catch{B.error("Something went wrong. Please try again.")}finally{y(!1)}},c=_=>{const j=_.target.files?.[0];if(j){x(j);const U=new FileReader;U.onloadend=()=>{i(U.result)},U.readAsDataURL(j)}},w=()=>{x(null),i(a?.photo_url||null),A.current&&(A.current.value="")};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"contact_name",children:"Contact Name *"}),e.jsx(F,{id:"contact_name",value:n.contact_name,onChange:_=>l(j=>({...j,contact_name:_.target.value})),className:h.contact_name?"border-destruction":"",placeholder:"e.g., Uzzal Islam"}),h.contact_name&&e.jsx("p",{className:"text-destruction mt-1 text-sm",children:h.contact_name})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"relationship",children:"Relationship *"}),e.jsxs(V,{value:n.relationship,onValueChange:_=>l(j=>({...j,relationship:_})),children:[e.jsx(J,{className:h.relationship?"border-destruction":"",children:e.jsx(G,{placeholder:"Select relationship"})}),e.jsxs(H,{children:[e.jsx(k,{value:"spouse",children:"Spouse"}),e.jsx(k,{value:"parent",children:"Parent"}),e.jsx(k,{value:"child",children:"Child"}),e.jsx(k,{value:"sibling",children:"Sibling"}),e.jsx(k,{value:"relative",children:"Relative"}),e.jsx(k,{value:"friend",children:"Friend"}),e.jsx(k,{value:"colleague",children:"Colleague"}),e.jsx(k,{value:"other",children:"Other"})]})]}),h.relationship&&e.jsx("p",{className:"text-destruction mt-1 text-sm",children:h.relationship})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(F,{id:"phone",value:n.phone,onChange:_=>l(j=>({...j,phone:_.target.value})),className:h.phone?"border-destruction":"",placeholder:"e.g., +8801933126160"}),h.phone&&e.jsx("p",{className:"text-destruction mt-1 text-sm",children:h.phone})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"email",children:"Email Address"}),e.jsx(F,{id:"email",type:"email",value:n.email,onChange:_=>l(j=>({...j,email:_.target.value})),className:h.email?"border-destruction":"",placeholder:"e.g., uzzal@sagorislam.dev"}),h.email&&e.jsx("p",{className:"text-destruction mt-1 text-sm",children:h.email})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"address",children:"Address"}),e.jsx(ge,{id:"address",value:n.address,onChange:_=>l(j=>({...j,address:_.target.value})),className:h.address?"border-destruction":"",rows:3,placeholder:"e.g., 123 Main Street, Apt 4B, City, State, ZIP"}),h.address&&e.jsx("p",{className:"text-destruction mt-1 text-sm",children:h.address})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"photo",children:[t," Photo"]}),e.jsxs("div",{className:"space-y-4",children:[b&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:b,alt:"Contact preview",className:"size-16 rounded-full"}),e.jsx(f,{type:"button",variant:"outline",size:"sm",onClick:w,children:"Remove Photo"})]}),e.jsx(F,{ref:A,id:"photo",type:"file",accept:"image/*",onChange:c,className:h.photo?"border-destruction":""}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Upload a photo of the ",t.toLowerCase()," (max 2MB, 100x100 to 1000x1000 pixels)"]}),h.photo&&e.jsx("p",{className:"text-destruction text-sm",children:h.photo})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{id:"is_primary",checked:n.is_primary,onCheckedChange:_=>l(j=>({...j,is_primary:!!_}))}),e.jsxs(C,{htmlFor:"is_primary",children:["Primary ",t.toLowerCase()]})]}),e.jsxs("div",{className:"flex justify-end gap-2 border-t pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:s,disabled:m,children:"Cancel"}),e.jsx(f,{type:"button",onClick:T,disabled:m,children:m?"Saving...":a?"Update Contact":"Add Contact"})]})]})}function z({mode:a,open:r,contact:s,onSuccess:t,onCancel:o,resourceLabel:n="",subjectLabel:l=""}){const d=a==="edit";return e.jsx(W,{open:r,children:e.jsxs(X,{className:"max-w-2xl [&>button]:hidden",children:[e.jsxs(Y,{className:"mb-4",children:[e.jsx(Z,{children:d?`Edit ${n}`:`Add ${n}`}),e.jsx(be,{children:d?`Update the ${n.toLowerCase()} information.`:`Add a new ${n.toLowerCase()} for this ${l.toLowerCase()}.`})]}),e.jsx(ye,{contact:d?s:void 0,onSuccess:t,onCancel:o,resourceLabel:n,subjectLabel:l})]})})}function Ne({label:a="Created By",userName:r,className:s,required:t=!0}){return e.jsxs("div",{className:s,children:[e.jsxs(C,{htmlFor:"created_by",children:[a," ",t&&"*"]}),e.jsx(F,{id:"created_by",value:r||"Current User",disabled:!0,className:"bg-muted"})]})}function q({id:a,label:r,value:s,onChange:t,error:o,placeholder:n,required:l=!1,className:d,min:x,max:b,disabled:i=!1}){return e.jsxs("div",{className:d,children:[e.jsxs(C,{htmlFor:a,children:[r," ",l&&"*"]}),e.jsx(F,{id:a,type:"date",value:s,onChange:m=>t(m.target.value),className:o?"border-destructive":"",placeholder:n,min:x,max:b,disabled:i}),o&&e.jsx("p",{className:"text-sm text-destructive",children:o})]})}function Ce({onReset:a,onSubmit:r,submitLabel:s="Save",resetLabel:t="Reset",processing:o=!1,showReset:n=!0,disabled:l=!1,className:d="mt-6 flex justify-end gap-4"}){return e.jsxs("div",{className:d,children:[n&&a&&e.jsx(f,{type:"button",variant:"outline",onClick:a,disabled:o||l,children:t}),e.jsx(f,{type:r?"button":"submit",onClick:r,disabled:o||l,children:o?"Saving...":s})]})}function L({id:a,label:r,value:s,onChange:t,placeholder:o,min:n,max:l,step:d=1,required:x=!1,disabled:b=!1,className:i=""}){const m=y=>{const h=y.target.value===""?0:Number(y.target.value);t(h)};return e.jsxs("div",{className:i,children:[e.jsxs(C,{htmlFor:a,children:[r,x&&e.jsx("span",{className:"ml-1 text-destructive",children:"*"})]}),e.jsx(F,{id:a,type:"number",value:s,onChange:m,placeholder:o,min:n,max:l,step:d,required:x,disabled:b})]})}function we({open:a,onOpenChange:r,photoUrl:s,photoName:t,title:o}){return e.jsx(W,{open:a,onOpenChange:r,children:e.jsxs(X,{className:"max-w-2xl",children:[e.jsx(Y,{children:e.jsx(Z,{children:o||`${t} - Photo`})}),e.jsx("div",{className:"flex justify-center",children:s&&e.jsx("img",{src:s,alt:t,className:"max-h-96 max-w-full rounded-lg border object-contain"})})]})})}function Se({label:a="Photo",value:r,onChange:s,onDelete:t,error:o,helpText:n="Upload a photo (max 2MB, JPEG/PNG/WebP)",accept:l="image/*",maxSizeText:d,previewUrl:x,className:b,required:i=!1}){const m=g.useRef(null),[y,h]=g.useState(null),P=x||y,A=c=>{const w=c.target.files?.[0]||null;if(s(w),w){const _=URL.createObjectURL(w);h(_)}else h(null)},T=()=>{s(null),h(null),t?.()};return e.jsxs("div",{className:b,children:[e.jsxs(C,{htmlFor:"photo",children:[a," ",i&&"*"]}),e.jsxs("div",{className:"flex items-start",children:[P&&e.jsxs("div",{className:"relative mr-4",children:[e.jsx("img",{src:P,alt:"Photo preview",className:"size-24 rounded-lg"}),e.jsx(f,{type:"button",variant:"destructive",size:"sm",className:"absolute -right-2 -bottom-2 size-6 cursor-pointer p-0 hover:scale-110",onClick:T,children:e.jsx(M,{className:"size-3"})})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{ref:m,id:"photo",type:"file",accept:l,onChange:A,className:"hidden"}),e.jsxs(f,{type:"button",variant:"outline",onClick:()=>m.current?.click(),className:"flex items-center gap-2",children:[e.jsx(_e,{className:"size-4"}),r?"Change Photo":"Upload Photo"]}),r&&e.jsx("span",{className:"text-sm text-muted-foreground",children:r.name})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n,d&&` (${d})`]}),o&&e.jsx("p",{className:"text-sm text-destructive",children:o})]})]})]})}function E({id:a,label:r,value:s,onChange:t,options:o,error:n,placeholder:l,required:d=!1,className:x,disabled:b=!1}){const i=s||void 0;return e.jsxs("div",{className:x,children:[e.jsxs(C,{htmlFor:a,children:[r," ",d&&"*"]}),e.jsxs(V,{value:i,onValueChange:t,disabled:b,children:[e.jsx(J,{className:n?"border-destructive":"",children:e.jsx(G,{placeholder:l||`Select ${r.toLowerCase()}`})}),e.jsx(H,{children:o.map(m=>e.jsx(k,{value:m.value,children:m.label},m.value))})]}),n&&e.jsx("p",{className:"text-sm text-destructive",children:n})]})}function De({tabs:a,className:r=""}){return e.jsx(re,{className:`grid w-full grid-cols-${a.length} ${r}`,children:a.map(s=>e.jsx(oe,{value:s.value,className:"cursor-pointer",children:s.label},s.value))})}function v({id:a,label:r,value:s,onChange:t,error:o,placeholder:n,required:l=!1,className:d,disabled:x=!1,type:b="text"}){return e.jsxs("div",{className:d,children:[e.jsxs(C,{htmlFor:a,children:[r," ",l&&"*"]}),e.jsx(F,{id:a,type:b,value:s,onChange:i=>t(i.target.value),className:o?"border-destructive":"",placeholder:n||`Enter ${r.toLowerCase()}`,disabled:x}),o&&e.jsx("p",{className:"text-sm text-destructive",children:o})]})}const $=a=>a?a.split("T")[0]:"";function Ee(a,r="tab"){const s=()=>typeof window<"u"&&new URLSearchParams(window.location.search).get(r)||a,[t,o]=g.useState(s()),n=l=>{if(o(l),typeof window<"u"){const d=new URL(window.location.href);d.searchParams.set(r,l),window.history.replaceState({},"",d.toString())}};return g.useEffect(()=>{if(typeof window<"u"){const d=new URLSearchParams(window.location.search).get(r);d&&d!==t&&o(d)}},[]),[t,n]}function Pe(){return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Contacts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact information is managed separately. You can add emergency contacts and additional phone numbers after saving."}),e.jsx("h3",{className:"mt-6 text-lg font-semibold",children:"Documents"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Employee documents can be uploaded after saving the profile. This includes contracts, certifications, and identification documents."}),e.jsx("h3",{className:"mt-6 text-lg font-semibold",children:"Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Internal notes and comments about the employee can be added in the employee detail view."})]})}function Ae(){return e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Attendance History"}),e.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"View and manage employee attendance records and time tracking."}),e.jsx(f,{variant:"outline",disabled:!0,children:"View Attendance"})]})}function ke({data:a,existingPhotoUrl:r,setData:s,errors:t,departments:o,designations:n,employmentTypes:l,auth:d}){const[x,b]=g.useState(r||null);return e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(v,{id:"employee_code",label:"Employee Code",value:a.employee_code,onChange:i=>s("employee_code",i),error:t.employee_code,required:!0,placeholder:"Enter employee code (e.g., EMP001)"}),e.jsx(v,{id:"email",label:"Email Address",type:"email",value:a.email,onChange:i=>s("email",i),error:t.email,required:!0,placeholder:"Enter email address (e.g., me@sagorislam.dev)"}),e.jsx(v,{id:"first_name",label:"First Name",value:a.first_name,onChange:i=>s("first_name",i),error:t.first_name,required:!0,placeholder:"Enter first name (e.g., Sagor)"}),e.jsx(v,{id:"last_name",label:"Last Name",value:a.last_name,onChange:i=>s("last_name",i),error:t.last_name,required:!0,placeholder:"Enter last name (e.g., Islam)"}),e.jsx(v,{id:"phone",label:"Phone Number",type:"tel",value:a.phone,onChange:i=>s("phone",i),error:t.phone,placeholder:"Enter phone number (e.g., +8801933126160)"}),e.jsx(E,{id:"department_id",label:"Department",required:!0,value:a.department_id,onChange:i=>s("department_id",i),options:o.map(i=>({value:i.id,label:i.name}))}),e.jsx(E,{id:"designation_id",label:"Designation",required:!0,value:a.designation_id,onChange:i=>s("designation_id",i),options:n.map(i=>({value:i.id,label:i.title}))}),e.jsx(E,{id:"employment_status",label:"Employment Status",required:!0,value:a.employment_status,onChange:i=>s("employment_status",i),options:[{value:"active",label:"Active"},{value:"inactive",label:"InActive"},{value:"terminated",label:"Terminated"},{value:"on_leave",label:"On Leave"}]}),e.jsx(E,{id:"employment_type",label:"Employment Type",required:!0,value:a.employment_type,onChange:i=>s("employment_type",i),options:l.map(i=>({value:i.code,label:i.name}))}),e.jsx(q,{id:"joining_date",label:"Joining Date",value:a.joining_date,onChange:i=>s("joining_date",i),error:t.joining_date,required:!0}),e.jsx(Se,{value:a.photo,onChange:i=>{if(s("photo",i),i){const m=URL.createObjectURL(i);b(m),s("delete_photo",!1)}},onDelete:()=>{s("delete_photo",!0),b(null)},helpText:"Upload a profile photo (max 2MB, JPEG/PNG/WebP)",error:t.photo,previewUrl:x}),e.jsx(Ne,{userName:d?.user?.name})]})}function Fe({contacts:a,onContactAdd:r,onContactEdit:s,onContactDelete:t}){const[o,n]=g.useState(!1),[l,d]=g.useState(null),[x,b]=g.useState(null),[i,m]=g.useState(null),y=c=>{r(c),n(!1)},h=c=>{s(c),d(null)},P=()=>{n(!1)},A=()=>{d(null)},T=c=>{t(c),b(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Emergency Contacts"}),e.jsx(f,{type:"button",variant:"secondary",className:"border-2 border-blue-700",onClick:()=>n(!0),children:"Add Contact"})]}),e.jsx("div",{className:"space-y-4",children:a.filter(c=>!c._isDeleted).map(c=>{let w="border";return c._isNew?w="border-2 border-green-500":c._isModified&&(w="border-2 border-yellow-500"),e.jsx("div",{className:`rounded-lg ${w} p-4`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[c.photo_url&&e.jsxs("div",{className:"group relative",children:[e.jsx("img",{src:c.photo_url,alt:c.contact_name,className:"size-20 cursor-pointer rounded-full border object-cover transition-opacity hover:opacity-80",onClick:()=>m({url:c.photo_url,name:c.contact_name})}),e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center rounded-full bg-black/20 opacity-0 transition-opacity group-hover:opacity-100",children:e.jsx(de,{className:"size-6 text-white"})})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold",children:[c.contact_name,c.is_primary&&e.jsx(O,{className:"ml-2",variant:"default",children:"Primary"}),c._isNew&&e.jsx(O,{className:"ml-2 border-green-500 bg-green-100 text-green-800 hover:bg-green-200",variant:"outline",children:"New"}),c._isModified&&e.jsx(O,{className:"ml-2 border-yellow-500 bg-yellow-100 text-yellow-800 hover:bg-yellow-200",variant:"outline",children:"Modified"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{type:"button",variant:"outline",size:"sm",className:"cursor-pointer",onClick:()=>d(c.id),children:e.jsx(fe,{className:"h-4 w-4 text-primary"})}),e.jsx(f,{type:"button",variant:"outline",size:"sm",className:"cursor-pointer",onClick:()=>b(c.id),children:e.jsx(M,{className:"h-4 w-4 text-destructive"})})]})]}),e.jsxs("div",{className:"grid gap-2 text-sm md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Relationship:"})," ",e.jsx("span",{className:"capitalize",children:c.relationship})]}),c.email&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Email:"})," ",c.email]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Phone:"})," ",c.phone]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Address:"})," ",c.address]})]})]})]})},c.id)})}),e.jsx(z,{mode:"add",open:o,onSuccess:y,onCancel:P,resourceLabel:"Emergency Contact",subjectLabel:"employee"}),e.jsx(z,{mode:"edit",open:!!l,contact:a.find(c=>c.id===l),onSuccess:h,onCancel:A,resourceLabel:"Emergency Contact",subjectLabel:"employee"}),e.jsx(ve,{open:!!x,onOpenChange:c=>{c||b(null)},onConfirm:()=>{x&&T(x)},title:"Delete Emergency Contact",description:"Are you sure you want to delete this emergency contact? This action cannot be undone.",confirmLabel:"Delete Contact"}),e.jsx(we,{open:i!==null,onOpenChange:c=>!c&&m(null),photoUrl:i?.url||null,photoName:i?.name||"",title:`${i?.name} - Contact Photo`})]})}function Te(){return e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Employee Documents"}),e.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Upload and manage employee documents like contracts, certificates, and identification."}),e.jsx(f,{variant:"outline",disabled:!0,children:"Upload Document"})]})}function Be({data:a,setData:r,supervisors:s,employmentTypes:t,isSuperAdminOrOwner:o}){const n=(l,d)=>{r("job_detail",{...a.job_detail,[l]:d})};return e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(v,{id:"job_title",label:"Job Title",required:!0,value:a.job_detail.job_title,onChange:l=>n("job_title",l),placeholder:"e.g., Software Engineer"}),e.jsx(E,{id:"employment_type",label:"Employment Type",required:!0,value:a.job_detail.employment_type,onChange:l=>n("employment_type",l),options:t.map(l=>({value:l.code,label:l.name}))}),e.jsx(E,{id:"supervisor_id",label:"Supervisor",value:a.job_detail.supervisor_id,onChange:l=>n("supervisor_id",l),options:s.map(l=>({value:l.id,label:`${l.name} (${l.employee_code})`})),required:!o}),e.jsx(E,{id:"work_shift",label:"Work Shift",required:!0,value:a.job_detail.work_shift,onChange:l=>n("work_shift",l),options:[{value:"day",label:"Day"},{value:"night",label:"Night"},{value:"rotating",label:"Rotating"},{value:"flexible",label:"Flexible"}]}),e.jsx(q,{id:"probation_end_date",label:"Probation End Date",required:!0,value:a.job_detail.probation_end_date,onChange:l=>n("probation_end_date",l)}),e.jsx(q,{id:"contract_end_date",label:"Contract End Date",required:!0,value:a.job_detail.contract_end_date,onChange:l=>n("contract_end_date",l)})]})}function Ue(){return e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Leave History"}),e.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"View and manage employee leave requests and balances."}),e.jsx(f,{variant:"outline",disabled:!0,children:"View Leave Records"})]})}function Le(){return e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Internal Notes"}),e.jsx("p",{className:"mb-4 text-sm text-muted-foreground",children:"Add internal notes and comments about this employee."}),e.jsx(f,{variant:"outline",disabled:!0,children:"Add Note"})]})}function $e({data:a,setData:r}){const s=(t,o)=>{r("personal_detail",{...a.personal_detail,[t]:o})};return e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(q,{id:"date_of_birth",label:"Date of Birth",value:a.personal_detail.date_of_birth,onChange:t=>s("date_of_birth",t)}),e.jsx(E,{id:"gender",label:"Gender",required:!0,value:a.personal_detail.gender,onChange:t=>s("gender",t),options:[{value:"male",label:"Male"},{value:"female",label:"Female"}]}),e.jsx(E,{id:"marital_status",label:"Marital Status",required:!0,value:a.personal_detail.marital_status,onChange:t=>s("marital_status",t),options:[{value:"single",label:"Single"},{value:"married",label:"Married"},{value:"divorced",label:"Divorced"},{value:"widowed",label:"Widowed"}]}),e.jsx(E,{id:"blood_group",label:"Blood Group",value:a.personal_detail.blood_group,onChange:t=>s("blood_group",t),options:[{value:"A+",label:"A+"},{value:"A-",label:"A-"},{value:"B+",label:"B+"},{value:"B-",label:"B-"},{value:"AB+",label:"AB+"},{value:"AB-",label:"AB-"},{value:"O+",label:"O+"},{value:"O-",label:"O-"}]}),e.jsx(v,{id:"national_id",label:"National ID",required:!0,value:a.personal_detail.national_id,onChange:t=>s("national_id",t),placeholder:"e.g., 12345678901234"}),e.jsx(v,{id:"passport_number",label:"Passport Number",value:a.personal_detail.passport_number,onChange:t=>s("passport_number",t),placeholder:"e.g., A123456789"}),e.jsx(v,{id:"address",label:"Address",required:!0,value:a.personal_detail.address,onChange:t=>s("address",t),placeholder:"e.g., 123 Main St, Apt 4B"}),e.jsx(v,{id:"city",label:"City",required:!0,value:a.personal_detail.city,onChange:t=>s("city",t),placeholder:"e.g., Dhaka"}),e.jsx(v,{id:"country",label:"Country",required:!0,value:a.personal_detail.country,onChange:t=>s("country",t),placeholder:"e.g., Bangladesh"})]})}function qe({data:a,setData:r}){const s=(t,o)=>{r("salary_detail",{...a.salary_detail,[t]:o})};return e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(L,{id:"basic_salary",label:"Basic Salary",required:!0,value:a.salary_detail.basic_salary,onChange:t=>s("basic_salary",t),placeholder:"e.g., 50000",min:0}),e.jsx(L,{id:"allowances",label:"Allowances",value:a.salary_detail.allowances,onChange:t=>s("allowances",t),placeholder:"e.g., 10000",min:0}),e.jsx(L,{id:"deductions",label:"Deductions",value:a.salary_detail.deductions,onChange:t=>s("deductions",t),placeholder:"e.g., 5000",min:0}),e.jsx(L,{id:"net_salary",label:"Net Salary",value:a.salary_detail.net_salary,onChange:t=>s("net_salary",t),placeholder:"e.g., 55000",min:0}),e.jsx(v,{id:"bank_name",label:"Bank Name",value:a.salary_detail.bank_name,onChange:t=>s("bank_name",t),placeholder:"e.g., BRAC Bank"}),e.jsx(v,{id:"bank_account_number",label:"Bank Account Number",value:a.salary_detail.bank_account_number,onChange:t=>s("bank_account_number",t),placeholder:"e.g., 0123456789"}),e.jsx(v,{id:"bank_branch",label:"Bank Branch",value:a.salary_detail.bank_branch,onChange:t=>s("bank_branch",t),placeholder:"e.g., Dhanmondi Branch"}),e.jsx(v,{id:"tax_id",label:"Tax ID",value:a.salary_detail.tax_id,onChange:t=>s("tax_id",t),placeholder:"e.g., TAX123456"})]})}function Re({employee:a,departments:r,designations:s,employmentTypes:t,supervisors:o,auth:n,className:l}){const[d,x]=g.useState(a.contacts||[]),[b,i]=Ee("basic"),{data:m,setData:y,post:h,processing:P,errors:A,reset:T,clearErrors:c,isDirty:w}=se({employee_code:a.employee_code,first_name:a.first_name,last_name:a.last_name,email:a.email,phone:a.phone||"",photo:null,delete_photo:!1,_method:"put",department_id:a.department?.id||"",designation_id:a.designation?.id||"",employment_status:a.employment_status,employment_type:a.employment_type,joining_date:$(a.joining_date),personal_detail:{date_of_birth:$(a.personal_detail?.date_of_birth),gender:a.personal_detail?.gender||"",marital_status:a.personal_detail?.marital_status||"",blood_group:a.personal_detail?.blood_group||"",national_id:a.personal_detail?.national_id||"",passport_number:a.personal_detail?.passport_number||"",address:a.personal_detail?.address||"",city:a.personal_detail?.city||"",country:a.personal_detail?.country||""},job_detail:{job_title:a.job_detail?.job_title||"",employment_type:a.job_detail?.employment_type||a.employment_type,supervisor_id:a.job_detail?.supervisor_id||"",work_shift:a.job_detail?.work_shift||"",probation_end_date:$(a.job_detail?.probation_end_date),contract_end_date:$(a.job_detail?.contract_end_date)},salary_detail:{basic_salary:a.salary_detail?.basic_salary||"",allowances:a.salary_detail?.allowances||"",deductions:a.salary_detail?.deductions||"",net_salary:a.salary_detail?.net_salary||"",bank_name:a.salary_detail?.bank_name||"",bank_account_number:a.salary_detail?.bank_account_number||"",bank_branch:a.salary_detail?.bank_branch||"",tax_id:a.salary_detail?.tax_id||""}}),_=async N=>{N.preventDefault();try{await new Promise((u,p)=>{h(ue(a.id).url,{forceFormData:!0,onSuccess:()=>u(),onError:()=>p(new Error("Employee update failed"))})});const S=d.filter(u=>u._isNew||u._isModified||u._isDeleted);for(const u of S)try{if(u._isNew&&u._isDeleted)continue;if(u._isDeleted&&!u._isNew)await R.delete(`/dashboard/employees/${a.id}/contacts/${u.id}`);else if(u._isNew&&!u._isDeleted){const p=new FormData;p.append("contact_name",u.contact_name),p.append("relationship",u.relationship),p.append("phone",u.phone),p.append("email",u.email||""),p.append("address",u.address||""),p.append("is_primary",u.is_primary?"1":"0"),u._photoFile&&p.append("photo",u._photoFile),await R.post(`/dashboard/employees/${a.id}/contacts`,p,{headers:{"Content-Type":"multipart/form-data"}})}else if(u._isModified){const p=new FormData;p.append("contact_name",u.contact_name),p.append("relationship",u.relationship),p.append("phone",u.phone),p.append("email",u.email||""),p.append("address",u.address||""),p.append("is_primary",u.is_primary?"1":"0"),p.append("_method","put"),u._photoFile&&p.append("photo",u._photoFile),await R.post(`/dashboard/employees/${a.id}/contacts/${u.id}`,p,{headers:{"Content-Type":"multipart/form-data"}})}}catch(p){console.error("Failed to sync contact:",u,p),B.error(`Failed to sync contact: ${u.contact_name}`)}le.reload({only:["employee"],onSuccess:u=>{const p=u.props.employee;p?.contacts&&(x(p.contacts),console.log("Contacts refreshed via Inertia:",p.contacts)),B.success("Employee and contacts updated successfully!")},onError:()=>{B.error("Failed to refresh data. Please refresh the page.")}})}catch(S){console.error("Update failed:",S),B.error("Failed to update employee. Please try again.")}},j=()=>{T(),c()},U=N=>{x(d.map(S=>S.id===N?{...S,_isDeleted:!0}:S)),B.success("Contact deletion staged - save employee to apply"),i("contacts")},K=N=>{x([...d,N]),i("contacts")},Q=N=>{x(d.map(S=>S.id===N.id?N:S)),i("contacts")},ee=w||d.some(N=>N._isNew||N._isModified||N._isDeleted),ae=n?.user?.is_super_admin||n?.user?.roles?.some(N=>N.name==="Admin"),te=[{value:"basic",label:"Basic"},{value:"personal",label:"Personal"},{value:"job",label:"Job"},{value:"salary",label:"Salary"},{value:"contacts",label:"Contacts"},{value:"documents",label:"Documents"},{value:"notes",label:"Notes"},{value:"attendance",label:"Attendance"},{value:"leave",label:"Leave"},{value:"additional",label:"Additional"}];return e.jsx("div",{className:l,children:e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs(ce,{value:b,onValueChange:i,className:"space-y-6",children:[e.jsx(De,{tabs:te}),e.jsx(D,{value:"basic",className:"space-y-6",children:e.jsx(ke,{data:{employee_code:m.employee_code,email:m.email,first_name:m.first_name,last_name:m.last_name,phone:m.phone,department_id:m.department_id,designation_id:m.designation_id,employment_status:m.employment_status,employment_type:m.employment_type,joining_date:m.joining_date,photo:m.photo,delete_photo:m.delete_photo},existingPhotoUrl:a.photo_url,setData:y,errors:A,departments:r,designations:s,employmentTypes:t,auth:n})}),e.jsx(D,{value:"personal",className:"space-y-6",children:e.jsx($e,{data:{personal_detail:m.personal_detail},setData:y})}),e.jsx(D,{value:"job",className:"space-y-6",children:e.jsx(Be,{data:{job_detail:m.job_detail},setData:y,supervisors:o,employmentTypes:t,isSuperAdminOrOwner:ae||!1})}),e.jsx(D,{value:"salary",className:"space-y-6",children:e.jsx(qe,{data:{salary_detail:m.salary_detail},setData:y})}),e.jsx(D,{value:"contacts",className:"space-y-6",children:e.jsx(Fe,{contacts:d,onContactAdd:K,onContactEdit:Q,onContactDelete:U})}),e.jsx(D,{value:"documents",className:"space-y-6",children:e.jsx(Te,{})}),e.jsx(D,{value:"notes",className:"space-y-6",children:e.jsx(Le,{})}),e.jsx(D,{value:"attendance",className:"space-y-6",children:e.jsx(Ae,{})}),e.jsx(D,{value:"leave",className:"space-y-6",children:e.jsx(Ue,{})}),e.jsx(D,{value:"additional",className:"space-y-6",children:e.jsx(Pe,{})})]}),e.jsx(Ce,{onReset:j,submitLabel:"Update",processing:P,disabled:!ee})]})})}function ra({employee:a,departments:r,designations:s,employmentTypes:t,supervisors:o,auth:n}){const l=[{title:"Employees",href:I().url},{title:`${a.first_name} ${a.last_name}`,href:he(a.id).url},{title:"Edit",href:pe(a.id).url}];return e.jsxs(xe,{breadcrumbs:l,children:[e.jsx(ne,{title:`Edit ${a.first_name} ${a.last_name}`}),e.jsxs("div",{className:"mx-auto flex h-full w-7xl flex-1 flex-col gap-8 overflow-x-auto rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Employee Profile"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Complete profile information for"," ",e.jsxs("span",{className:"font-bold",children:[a.first_name," ",a.last_name]})]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(f,{variant:"secondary",size:"sm",asChild:!0,children:e.jsxs(ie,{href:I().url,children:[e.jsx(me,{className:"mr-1 size-4"}),"Back"]})})})]}),e.jsx(Re,{employee:a,departments:r,designations:s,employmentTypes:t,supervisors:o,auth:n,className:"relative overflow-hidden rounded-xl border border-sidebar-border/70 bg-card p-6 shadow-sm dark:border-sidebar-border"})]})]})}export{ra as default};
